From e3a73d9aca9e693ef81f22d88c7a9e371b8d0681 Mon Sep 17 00:00:00 2001
From: ksrt12 <kazakov12stepan2012@live.ru>
Date: Thu, 20 Jul 2017 16:00:51 +0300
Subject: [PATCH] fix core [1/2]

Change-Id: Idf3c963f2a17ba126e2925de99ab92a04c219936
---
 rootdir/init.rc | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/rootdir/init.rc b/rootdir/init.rc
index 94f64e0b6..20ab124ee 100644
--- a/rootdir/init.rc
+++ b/rootdir/init.rc
@@ -151,6 +151,15 @@ on init
     write /dev/cpuctl/cpu.rt_period_us 1000000
     write /dev/cpuctl/cpu.rt_runtime_us 950000
 
+    mkdir /dev/cpuctl/bg_non_interactive
+    chown system system /dev/cpuctl/bg_non_interactive/tasks
+    chmod 0666 /dev/cpuctl/bg_non_interactive/tasks
+    # 5.0 %
+    write /dev/cpuctl/bg_non_interactive/cpu.shares 52
+    write /dev/cpuctl/bg_non_interactive/cpu.rt_period_us 1000000
+    # active FIFO threads will never be in BG
+    write /dev/cpuctl/bg_non_interactive/cpu.rt_runtime_us 10000
+
     # sets up initial cpusets for ActivityManager
     mkdir /dev/cpuset
     mount cpuset none /dev/cpuset
-- 
2.13.0

